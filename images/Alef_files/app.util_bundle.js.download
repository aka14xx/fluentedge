!function(){var $,numberPolyfill,i;$=jQuery,(i=document.createElement("input")).setAttribute("type","number"),"text"!==i.type?$.fn.inputNumber=function(){return $(this)}:($.fn.inputNumber=function(){return $(this).filter(function(){var $this=$(this);return $this.is('input[type="number"]')&&!($this.parent().is("span")&&$this.next().is("div.number-spin-btn-container")&&$this.next().children().first().is("div.number-spin-btn-up")&&$this.next().children().eq(1).is("div.number-spin-btn-down"))}).each(function(){numberPolyfill.polyfills.push(new numberPolyfill(this))}),$(this)},(numberPolyfill=function(elem){var MutationObserver,halfHeight,_this=this;if(this.elem=$(elem),!(this.elem.is(":root *")&&0<this.elem.height()))throw new Error("Element must be in DOM and displayed so that its height can be measured.");halfHeight=this.elem.outerHeight()/2+"px",this.upBtn=$("<div/>",{class:"number-spin-btn number-spin-btn-up",style:"height: "+halfHeight}),this.downBtn=$("<div/>",{class:"number-spin-btn number-spin-btn-down",style:"height: "+halfHeight}),this.btnContainer=$("<div/>",{class:"number-spin-btn-container"}),halfHeight=$("<span/>",{style:"white-space: nowrap"}),this.upBtn.appendTo(this.btnContainer),this.downBtn.appendTo(this.btnContainer),this.elem.wrap(halfHeight),this.btnContainer.insertAfter(this.elem),this.elem.on({focus(e){_this.elem.on({DOMMouseScroll:numberPolyfill.domMouseScrollHandler,mousewheel:numberPolyfill.mouseWheelHandler},{p:_this})},blur(e){_this.elem.off({DOMMouseScroll:numberPolyfill.domMouseScrollHandler,mousewheel:numberPolyfill.mouseWheelHandler})}}),this.elem.on({keypress:numberPolyfill.elemKeypressHandler,change:numberPolyfill.elemChangeHandler},{p:this}),this.upBtn.on("mousedown",{p:this,func:"increment"},numberPolyfill.elemBtnMousedownHandler),this.downBtn.on("mousedown",{p:this,func:"decrement"},numberPolyfill.elemBtnMousedownHandler),this.elem.css("textAlign","right"),this.attrMutationHandler("class"),"undefined"!=typeof WebKitMutationObserver&&null!==WebKitMutationObserver||null!=MutationObserver?new(MutationObserver="undefined"!=typeof WebKitMutationObserver&&null!==WebKitMutationObserver&&null==MutationObserver?WebKitMutationObserver:MutationObserver)(function(mutations,observer){for(var mutation,_i=0,_len=mutations.length;_i<_len;_i++)"attributes"===(mutation=mutations[_i]).type&&_this.attrMutationHandler(mutation.attributeName,mutation.oldValue,_this.elem.attr(mutation.attributeName))}).observe(elem,{attributes:!0,attributeOldValue:!0,attributeFilter:["class","style","min","max","step"]}):"undefined"!=typeof MutationEvent&&null!==MutationEvent&&this.elem.on("DOMAttrModified",function(evt){_this.attrMutationHandler(evt.originalEvent.attrName,evt.originalEvent.prevValue,evt.originalEvent.newValue)})}).polyfills=[],numberPolyfill.isNumber=function(input){return null!=input&&"function"==typeof input.toString&&/^-?\d+(?:\.\d+)?$/.test(input.toString())},numberPolyfill.isFloat=function(input){return null!=input&&"function"==typeof input.toString&&/^-?\d+\.\d+$/.test(input.toString())},numberPolyfill.isInt=function(input){return null!=input&&"function"==typeof input.toString&&/^-?\d+$/.test(input.toString())},numberPolyfill.isNegative=function(input){return null!=input&&"function"==typeof input.toString&&/^-\d+(?:\.\d+)?$/.test(input.toString())},numberPolyfill.raiseNum=function(num){var nump;return"number"==typeof num||"object"==typeof num&&num instanceof Number?num%1?{num:num.toString(),precision:0}:numberPolyfill.raiseNum(num.toString()):"string"==typeof num||"object"==typeof num&&num instanceof String?numberPolyfill.isFloat(num)?(num=num.replace(/(\.\d)0+$/,"$1"),nump=numberPolyfill.getPrecision(num),{num:(num.slice(0,-(nump+1))+num.slice(-nump)).replace(/^(-?)0+(\d+)/,"$1$2"),precision:nump}):numberPolyfill.isInt(num)?{num:num,precision:0}:void 0:void 0},numberPolyfill.raiseNumPrecision=function(rNum,newPrecision){var _i,_ref;if(rNum.precision<newPrecision){for(i=_i=_ref=rNum.precision;_ref<=newPrecision?_i<newPrecision:newPrecision<_i;i=_ref<=newPrecision?++_i:--_i)rNum.num+="0";rNum.precision=newPrecision}},numberPolyfill.lowerNum=function(num){if(0<num.precision){for(;num.num.length<num.precision+1;)numberPolyfill.isNegative(num.num)?num.num=num.num.slice(0,1)+"0"+num.num.slice(1):num.num="0"+num.num;return(num.num.slice(0,-num.precision)+"."+num.num.slice(-num.precision)).replace(/\.?0+$/,"").replace(/^(-?)(\.)/,"$10$2")}return num.num},numberPolyfill.preciseAdd=function(num1,num2){var num1i,num2i,result;if(("number"==typeof num1||"object"==typeof num1&&num1 instanceof Number)&&("number"==typeof num2||"object"==typeof num2&&num2 instanceof Number))return num1%1==0&&num2%1==0?(num1+num2).toString():numberPolyfill.preciseAdd(num1.toString(),num2.toString());if(("string"==typeof num1||"object"==typeof num1&&num1 instanceof String)&&("string"==typeof num2||"object"==typeof num2&&num2 instanceof String)){if(numberPolyfill.isNumber(num1)){if(numberPolyfill.isNumber(num2)){if(numberPolyfill.isInt(num1)){if(numberPolyfill.isInt(num2))return numberPolyfill.preciseAdd(parseInt(num1,10),parseInt(num2,10));numberPolyfill.isFloat(num2)&&(num1+=".0")}else numberPolyfill.isFloat(num1)&&numberPolyfill.isInt(num2)&&(num2+=".0");if(num1i=numberPolyfill.raiseNum(num1),num2i=numberPolyfill.raiseNum(num2),num1i.precision<num2i.precision?numberPolyfill.raiseNumPrecision(num1i,num2i.precision):num1i.precision>num2i.precision&&numberPolyfill.raiseNumPrecision(num2i,num1i.precision),result=(parseInt(num1i.num,10)+parseInt(num2i.num,10)).toString(),0<num1i.precision){if(numberPolyfill.isNegative(result))for(;num1i.precision>result.length-1;)result="-0"+result.slice(1);else for(;num1i.precision>result.length;)result="0"+result;result=numberPolyfill.lowerNum({num:result,precision:num1i.precision})}return result=result.replace(/^(-?)\./,"$10."),result=numberPolyfill.isFloat(result)?result.replace(/0+$/,""):result}throw new SyntaxError('Argument "'+num2+'" is not a number.')}throw new SyntaxError('Argument "'+num1+'" is not a number.')}return numberPolyfill.preciseAdd(num1.toString(),num2.toString())},numberPolyfill.preciseSubtract=function(num1,num2){return"number"==typeof num2||"object"==typeof num2&&num2 instanceof Number?numberPolyfill.preciseAdd(num1,-num2):"string"==typeof num2||"object"==typeof num2&&num2 instanceof String?numberPolyfill.isNegative(num2)?numberPolyfill.preciseAdd(num1,num2.slice(1)):numberPolyfill.preciseAdd(num1,"-"+num2):void 0},numberPolyfill.getPrecision=function(num){var k,kNum;if("number"==typeof num){for(k=0,kNum=num;kNum!==Math.floor(kNum);)kNum=num*Math.pow(10,++k);return k}if("string"==typeof num&&numberPolyfill.isNumber(num))return numberPolyfill.isFloat(num)?/^-?\d+(?:\.(\d+))?$/.exec(num)[1].length:0},numberPolyfill.prototype.getParams=function(){var step=this.elem.attr("step"),min=this.elem.attr("min"),max=this.elem.attr("max"),val=this.elem.val();return numberPolyfill.isNumber(step)||(step=null),{min:null!=(min=numberPolyfill.isNumber(min)?min:null)?min:null,max:null!=(max=numberPolyfill.isNumber(max)?max:null)?max:null,step:null!=step?step:"1",val:null!=(val=numberPolyfill.isNumber(val)?val:min||0)?val:null}},numberPolyfill.prototype.clipValues=function(value,min,max){return null!=max&&parseFloat(value)>parseFloat(max)?max:null!=min&&parseFloat(value)<parseFloat(min)?min:value},numberPolyfill.prototype.stepNormalize=function(value){var cValue,params=this.getParams(),step=params.step,params=params.min;return null==step||(step=numberPolyfill.raiseNum(step),(cValue=numberPolyfill.raiseNum(value)).precision>step.precision?numberPolyfill.raiseNumPrecision(step,cValue.precision):cValue.precision<step.precision&&numberPolyfill.raiseNumPrecision(cValue,step.precision),null!=params&&(cValue=numberPolyfill.raiseNum(numberPolyfill.preciseSubtract(value,params)),numberPolyfill.raiseNumPrecision(cValue,step.precision)),parseFloat(cValue.num)%parseFloat(step.num)==0)?value:(cValue=numberPolyfill.lowerNum({num:(Math.round(parseFloat(cValue.num)/(value=parseFloat(step.num)))*value).toString(),precision:cValue.precision}),null!=params?numberPolyfill.preciseAdd(cValue,params):cValue)},numberPolyfill.domMouseScrollHandler=function(evt){var p=evt.data.p;evt.preventDefault(),evt.originalEvent.detail<0?p.increment():p.decrement()},numberPolyfill.mouseWheelHandler=function(evt){var p=evt.data.p;evt.preventDefault(),0<evt.originalEvent.wheelDelta?p.increment():p.decrement()},numberPolyfill.elemKeypressHandler=function(evt){var p=evt.data.p;38===evt.keyCode?p.increment():40===evt.keyCode?p.decrement():8!==(p=evt.keyCode)&&9!==p&&35!==p&&36!==p&&37!==p&&39!==p&&46!==p&&45!==(p=evt.which)&&46!==p&&48!==p&&49!==p&&50!==p&&51!==p&&52!==p&&53!==p&&54!==p&&55!==p&&56!==p&&57!==p&&evt.preventDefault()},numberPolyfill.elemChangeHandler=function(evt){var params,evt=evt.data.p;""!==evt.elem.val()&&(numberPolyfill.isNumber(evt.elem.val())?(params=evt.getParams(),params=evt.clipValues(params.val,params.min,params.max),(params=evt.stepNormalize(params)).toString()!==evt.elem.val()&&evt.elem.val(params).trigger("change")):(params=evt.elem.attr("min"),evt.elem.val(null!=params&&numberPolyfill.isNumber(params)?params:"0").trigger("change")))},numberPolyfill.elemBtnMousedownHandler=function(evt){var releaseFunc,timeoutFunc,_this=this,p=evt.data.p,func=evt.data.func;p[func](),timeoutFunc=function(incFunc){p[func](),p.timeoutID=window.setTimeout(timeoutFunc,10)},releaseFunc=function(e){window.clearTimeout(p.timeoutID),$(document).off("mouseup",releaseFunc),$(_this).off("mouseleave",releaseFunc)},$(document).on("mouseup",releaseFunc),$(this).on("mouseleave",releaseFunc),p.timeoutID=window.setTimeout(timeoutFunc,700)},numberPolyfill.prototype.attrMutationHandler=function(name,oldValue,newValue){var ei,h,_i,_len,_ref;if("class"===name||"style"===name){for(h={},_i=0,_len=(_ref=["opacity","visibility","-moz-transition-property","-moz-transition-duration","-moz-transition-timing-function","-moz-transition-delay","-webkit-transition-property","-webkit-transition-duration","-webkit-transition-timing-function","-webkit-transition-delay","-o-transition-property","-o-transition-duration","-o-transition-timing-function","-o-transition-delay","transition-property","transition-duration","transition-timing-function","transition-delay"]).length;_i<_len;_i++)i=_ref[_i],(ei=this.elem.css(i))!==this.btnContainer.css(i)&&(h[i]=ei);"none"===this.elem.css("display")?h.display="none":h.display="inline-block",this.btnContainer.css(h)}else"min"!==name&&"max"!==name&&"step"!==name||this.elem.trigger("change")},numberPolyfill.prototype.increment=function(){var newVal,params;this.elem.is(":disabled")||this.elem.is("[readonly]")||(params=this.getParams(),newVal=numberPolyfill.preciseAdd(params.val,params.step),null!=params.max&&parseFloat(newVal)>parseFloat(params.max)&&(newVal=params.max),newVal=this.stepNormalize(newVal),this.elem.val(newVal).trigger("change"))},numberPolyfill.prototype.decrement=function(){var newVal,params;this.elem.is(":disabled")||this.elem.is("[readonly]")||(params=this.getParams(),newVal=numberPolyfill.preciseSubtract(params.val,params.step),null!=params.min&&parseFloat(newVal)<parseFloat(params.min)&&(newVal=params.min),newVal=this.stepNormalize(newVal),this.elem.val(newVal).trigger("change"))},$(function(){$('input[type="number"]').inputNumber()}))}.call(this);